{% extends "base_page.html" %}

{% comment %}
Copyright (C) 2012 Braden Walters

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}

{% load i18n %}

{% block head %}
  <script type="text/javascript" src="{{ STATIC_URL }}default/ajax_form_submit.js"></script>
  {% if not already_exists %}
    <script type="text/javascript">
      $(document).ready(function()
        {
          AjaxFormSubmit($('#form'), $('#loading'), $('#success'), $('#error'),
                         $('#error_message'), $('#error_reasons'));
        });
    </script>
  {% endif %}
  <script type="text/javascript">
    $(document).ready(function()
      {
        $('#delete').click(function()
          {
            return confirm('{% trans "are-you-sure-delete" %}');
          });
      });
  </script>
{% endblock %}

{% block body %}
  <div id="error" class="ajax_error">
    {% trans "error-occurred-card-data-not-saved" %}<br /><br />
    <b>{% trans "message" %}:</b><br />
    <span id="error_message"></span><br /><br />
    <div>
      <b>{% trans "reasons" %}:</b><br />
      <span id="error_reasons" style="list-style-position: inside;"></span>
    </div>
  </div>
  <div id="success" class="ajax_success">
    {% trans "success" %}!
  </div>
  <form id="form" action="{% if already_exists %}{% url edit-card set_id id %}{% else %}{% url new-card set_id %}{% endif %}" method="post" class="box_form">
    {% csrf_token %}
    {% for field in form %}
      {{ field.label_tag }}: {{ field }}
      {{ field.errors }}
    {% endfor %}
    {{ form.non_field_errors }}
    <br /><br />
    <input type="submit" value="{% if already_exists %}{% trans "edit" %}{% else %}{% trans "create" %}{% endif %}" class="box"/>
  </form>
  {% if already_exists %}
    <form action="{% url delete-card set_id id %}" method="POST" class="box_delete_form" style="padding-top: 20px;">
      {% csrf_token %}
      <input id="delete" type="submit" value="{% trans "delete" %}" />
    </form>
  {% endif %}
  <div id="loading" style="display: none;">
    <img src="{{ STATIC_URL }}common/ajax-loader.gif" alt="{% trans "loading" %}..." />
  </div>
{% endblock %}
